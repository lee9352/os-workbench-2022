# RAID
用多个磁盘一起组成一个存储系统，提高存储带宽
采取一些办法增加容错性

## RAID 0
把数据交错存放在不同磁盘里
没有冗余措施提升容错

## RAID 1
用两个盘存放相同的数据，相当于给数据做了个备份
读取数据时，可以同时从两个盘当中，分别读取一部分，从而也提升了存储带宽
但是写数据时，两个盘都需要被写入

## RAID 10
不是十，是一零
综合上述两种方案
先把数据用RAID 0形式交错存放在虚拟盘里面，然后再用RAID 1给这两虚拟盘做备份

这种方案，有时能容纳两块盘损坏(即两块虚拟盘的RAID 1分别有一块损坏了)
但有时只能容忍一块盘损坏(即不能同一虚拟盘的两份备份都坏掉)

## RAID 4
知识
对于n个bits b1,b2,...bn
对这n个bits做异或，得到一个校验码x
于是对于这n个bits而言，任意丢失一个的情况下，也可以用x与其余n-1个bits做异或给恢复出来

因为x^x=0
x^其余bits，相当于除了丢失的那一个，其余每一项都与自身异或过一次
所以最终得到的结果就是丢失的信息

于是RAID 4的方案就是对于n块盘，其中n-1块用raid 0的方式存放数据，剩余1块用于存放校验和

当出现数据损坏时，系统暂时无法工作，但可以恢复数据

缺点就是随机写的开销过大
因为不仅需要写数据，还需要把校验和与要写的位置原来的数据读出来，校验和先与原数据做异或(清除掉原数据)，再与新数据异或，然后写回

## RAID 5
把校验和也按照raid 0的方式交错存放在不同磁盘里面


# 崩溃一致性问题
正在写磁盘时，如果系统崩溃或者断电该怎么办
磁盘写入不是按照程序顺序来的，有可能会被调度策略修改

## FSCk
磁盘恢复
没太细说，大致意思就是用各种办法把磁盘数据恢复出来

## 日志
把要执行的操作和数据先写到日志里面(采用append的方式)
如果写日志的过程中出现崩溃，这个日志就不要了

日志写完了之后，再执行落盘操作，然后清空日志

### 日志优化
日志里面只写metadata
数据直接写到磁盘里面，数据写完之后，再往日志里面写元数据
